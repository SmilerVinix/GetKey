<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ace Key System • v6</title>

<style>
:root {
  --bg: #09090f;
  --card: #0f0f17;
  --text: #f1f5f9;
  --dim: #94a3b8;
  --accent: #22c55e;
  --accent-glow: rgba(34, 197, 94, 0.35);
  --border: rgba(255,255,255,0.06);
  --warning: #f59e0b;
  --progress: #3b82f6;
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  background: var(--bg);
  color: var(--text);
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  min-height: 100vh;
  overflow: hidden;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}

.bg-gradient {
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at 30% 20%, rgba(34,197,94,0.09), transparent 45%);
  animation: breathe 28s ease-in-out infinite;
  z-index: -2;
}

@keyframes breathe { 0%,100% { transform: scale(1); opacity: 0.6; } 50% { transform: scale(1.2); opacity: 0.85; } }

.particles { position: absolute; inset: 0; pointer-events: none; z-index: -1; }
.particle {
  position: absolute;
  background: var(--accent);
  border-radius: 50%;
  opacity: 0;
  animation: drift linear infinite;
}

@keyframes drift { 0% { transform: translateY(110vh) scale(0.2); opacity: 0; } 10% { opacity: 0.4; } 90% { opacity: 0.4; } 100% { transform: translateY(-40vh) scale(0.5); opacity: 0; } }

.step {
  position: fixed;
  inset: 0;
  background: var(--bg);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 24px;
  z-index: 100;
  transition: opacity 1s ease, visibility 0s linear 1.4s;
}

.hidden { opacity: 0; visibility: hidden; }

h2.big {
  font-size: 5rem;
  font-weight: 900;
  background: linear-gradient(90deg, #a1e65c, #4ade80, #22c55e);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-size: 300% auto;
  animation: gradientFlow 7s linear infinite;
  text-shadow: 0 0 60px rgba(34,197,94,0.7);
}

@keyframes gradientFlow { to { background-position: 300% center; } }

.by { margin: 24px 0 12px; font-size: 1.6rem; color: var(--dim); }
.love { font-size: 1.3rem; color: #fda4af; }

h1 { font-size: 2.4rem; margin-bottom: 16px; }
p { font-size: 1.1rem; color: var(--dim); max-width: 480px; margin: 0 auto 32px; line-height: 1.5; }

.progress-dots {
  display: flex;
  gap: 14px;
  margin-bottom: 36px;
}

.dot {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: #2a2a3a;
  transition: all 0.5s;
}

.dot.active { background: var(--accent); box-shadow: 0 0 16px var(--accent); transform: scale(1.5); }

.progress-bar {
  width: 80%;
  max-width: 400px;
  height: 10px;
  background: #1a1a28;
  border-radius: 999px;
  overflow: hidden;
  margin: 24px auto;
}

.bar-fill {
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, var(--progress), #60a5fa);
  transition: width 0.4s ease;
}

button {
  padding: 16px 40px;
  font-size: 1.15rem;
  font-weight: 700;
  border: none;
  border-radius: 18px;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  min-width: 240px;
  position: relative;
}

.primary { background: linear-gradient(90deg, #22c55e, #4ade80); color: #000; box-shadow: 0 10px 30px rgba(34,197,94,0.45); }
.primary:hover:not(:disabled) { transform: translateY(-4px) scale(1.04); box-shadow: 0 16px 50px rgba(34,197,94,0.65); }

button:disabled { opacity: 0.55; cursor: not-allowed; transform: none; box-shadow: none; }

button.loading::after {
  content: "";
  position: absolute;
  width: 20px; height: 20px;
  border: 3px solid #000;
  border-top-color: transparent;
  border-radius: 50%;
  right: 24px;
  animation: spin 1s linear infinite;
}

@keyframes spin { to { transform: rotate(360deg); } }

.container {
  width: 100%;
  max-width: 480px;
  background: var(--card);
  border-radius: 32px;
  border: 1px solid var(--border);
  padding: 44px 36px;
  text-align: center;
  box-shadow: 0 35px 90px rgba(0,0,0,0.8), inset 0 0 0 1px rgba(34,197,94,0.15);
  backdrop-filter: blur(14px);
  opacity: 0;
  transform: translateY(60px);
  animation: reveal 1.2s cubic-bezier(0.23,1,0.32,1.275) forwards;
}

@keyframes reveal { to { opacity: 1; transform: translateY(0); } }

.key-box {
  background: #0b0b12;
  border: 2px dashed rgba(34,197,94,0.45);
  border-radius: 20px;
  padding: 28px 20px;
  font-size: 1.5rem;
  font-family: 'Courier New', monospace;
  letter-spacing: 3.2px;
  margin: 32px 0;
  min-height: 100px;
  display: flex;
  align-items: center;
  justify-content: center;
  word-break: break-all;
  transition: all 0.6s;
}

.key-box.ready {
  border-style: solid;
  border-color: var(--accent);
  box-shadow: 0 0 60px var(--accent-glow);
  animation: keyPulse 3.2s infinite ease-in-out;
}

@keyframes keyPulse { 0%,100% { box-shadow: 0 0 40px rgba(34,197,94,0.3); } 50% { box-shadow: 0 0 80px rgba(34,197,94,0.55); } }

.status {
  font-size: 1.05rem;
  margin: 24px 0;
  min-height: 1.8em;
  line-height: 1.4;
}

.success { color: #4ade80; }
.error { color: #f87171; }
.wait { color: var(--warning); }

.footer { margin-top: 44px; font-size: 0.92rem; color: var(--dim); opacity: 0.8; }
</style>
</head>

<body>

<div class="bg-gradient"></div>
<div class="particles" id="particles"></div>

<!-- Intro -->
<div class="step" id="intro">
  <h2 class="big">Ace</h2>
  <div class="by">by aceii_</div>
  <div class="love">made with love ♡</div>
</div>

<!-- Step 1: Start -->
<div class="step hidden" id="step1">
  <h1>Human Verification Required</h1>
  <p>This quick multi-step process keeps things fair and blocks automated tools. It usually takes under 30 seconds.</p>
  <div class="progress-dots"><div class="dot active"></div><div class="dot"></div><div class="dot"></div></div>
  <button class="primary" id="startBtn">Begin Verification</button>
</div>

<!-- Step 2: PoW CAPTCHA -->
<div class="step hidden" id="step2">
  <h1>Proof-of-Work Challenge</h1>
  <p>Your device is solving a secure cryptographic puzzle in the background. This proves you're real and not a bot.</p>
  <div class="progress-dots"><div class="dot active"></div><div class="dot active"></div><div class="dot"></div></div>
  <div class="progress-bar"><div class="bar-fill" id="barFill"></div></div>
  <p id="progressText">Computing... ~5–20 seconds</p>
  <button class="primary loading" id="challengeBtn" disabled>Verifying...</button>
  <div id="challengeStatus" class="status"></div>
</div>

<!-- Main UI -->
<div class="container hidden" id="main">
  <h1>Ace Key System</h1>
  <div class="sub">Premium access key • v6</div>

  <div id="key" class="key-box">Verification passed → Generate your key</div>

  <button class="primary" id="generateBtn">Generate Key</button>
  <button class="secondary" id="copyBtn">Copy Key</button>

  <div id="status" class="status"></div>

  <div class="footer">by aceii_ • Key System v6 • 2026</div>
</div>

<script>
// Particles
function spawnParticles() {
  const c = document.getElementById('particles');
  for (let i = 0; i < 24; i++) {
    const p = document.createElement('div');
    p.className = 'particle';
    const sz = Math.random() * 6 + 2;
    p.style.width = p.style.height = sz + 'px';
    p.style.left = Math.random() * 100 + 'vw';
    p.style.animationDuration = (Math.random() * 30 + 20) + 's';
    p.style.animationDelay = Math.random() * -40 + 's';
    c.appendChild(p);
  }
}
spawnParticles();

// Transitions
setTimeout(() => {
  document.getElementById('intro').classList.add('hidden');
  setTimeout(() => document.getElementById('step1').classList.remove('hidden'), 600);
}, 3800);

document.getElementById('startBtn').addEventListener('click', () => {
  document.getElementById('step1').classList.add('hidden');
  setTimeout(() => document.getElementById('step2').classList.remove('hidden'), 500);
  runPoWChallenge();
});

// Rate limit (1 key / 60 min)
const RATE_MIN = 60;
const STORAGE_KEY = 'ace_key_last';
let userIP = null;

async function fetchIP() {
  try {
    const r = await fetch('https://api.ipify.org?format=json');
    const d = await r.json();
    userIP = d.ip;
  } catch {}
}
fetchIP();

function getLast() { return parseInt(localStorage.getItem(STORAGE_KEY) || '0'); }
function saveLast() { localStorage.setItem(STORAGE_KEY, Date.now()); }

function msFmt(ms) {
  const m = Math.floor(ms / 60000);
  const s = Math.floor((ms % 60000) / 1000);
  return `${m}m ${s}s`;
}

function cooldown(remain) {
  const btn = document.getElementById('generateBtn');
  const st = document.getElementById('status');
  btn.disabled = true;
  btn.textContent = 'Cooldown...';
  const iv = setInterval(() => {
    remain -= 1000;
    if (remain <= 0) {
      clearInterval(iv);
      btn.disabled = false;
      btn.textContent = 'Generate Key';
      st.textContent = '';
      return;
    }
    st.className = 'status wait';
    st.textContent = `Next key in ${msFmt(remain)}`;
  }, 1000);
}

// PoW Challenge - find nonce so SHA256(data + nonce) starts with "aceace"
async function runPoWChallenge() {
  const status = document.getElementById('challengeStatus');
  const bar = document.getElementById('barFill');
  const txt = document.getElementById('progressText');
  const btn = document.getElementById('challengeBtn');

  status.textContent = 'Computing secure proof...';
  txt.textContent = 'This may take 5–30 seconds depending on your device';

  const prefix = 'aceace'; // ~6 hex chars → moderate-hard (adjust: 'ace' easier, 'aceaceace' very hard)
  const base = 'aceii_key_challenge_' + Date.now() + Math.random().toString(36);
  let nonce = 0;
  const maxTries = 30000000; // safety
  let start = performance.now();

  while (nonce < maxTries) {
    const input = base + nonce;
    const hashBuf = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(input));
    const hashArr = Array.from(new Uint8Array(hashBuf));
    const hash = hashArr.map(b => b.toString(16).padStart(2,'0')).join('');

    if (hash.startsWith(prefix)) {
      const dur = ((performance.now() - start) / 1000).toFixed(1);
      status.className = 'status success';
      status.textContent = `Challenge passed in ${dur}s ✓`;
      bar.style.width = '100%';
      btn.classList.remove('loading');
      btn.textContent = 'Continue';
      btn.disabled = false;
      btn.onclick = () => {
        document.getElementById('step2').classList.add('hidden');
        setTimeout(() => document.getElementById('main').classList.remove('hidden'), 400);
      };
      return;
    }

    nonce++;
    if (nonce % 8000 === 0) {
      const progress = Math.min(95, (nonce / maxTries) * 100);
      bar.style.width = progress + '%';
      await new Promise(r => setTimeout(r, 0)); // yield
    }
  }

  status.className = 'status error';
  status.textContent = 'Challenge timed out — device too slow or error. Refresh page to retry.';
  btn.disabled = false;
  btn.textContent = 'Retry';
  btn.classList.remove('loading');
  btn.onclick = () => location.reload();
}

// Key gen logic
const keyEl = document.getElementById('key');
const genBtn = document.getElementById('generateBtn');
const copyBtn = document.getElementById('copyBtn');
const stat = document.getElementById('status');

function randBlock(n) {
  const c = "ABCDEFGHJKLMNPQRSTUVWXYZ23456789";
  let s = "";
  for (let i = 0; i < n; i++) s += c[Math.floor(Math.random() * c.length)];
  return s;
}

function showStat(msg, cls = '') {
  stat.textContent = msg;
  stat.className = `status ${cls}`;
}

genBtn.addEventListener('click', () => {
  const now = Date.now();
  const last = getLast();
  if (now - last < RATE_MIN * 60000) {
    const rem = RATE_MIN * 60000 - (now - last);
    showStat(`You've generated recently. Wait ${msFmt(rem)}`, 'wait');
    cooldown(rem);
    return;
  }

  genBtn.disabled = true;
  genBtn.classList.add('loading');
  genBtn.textContent = 'Generating...';

  setTimeout(() => {
    const k = `ACE-${randBlock(5)}-${randBlock(5)}-${randBlock(4)}`;
    keyEl.textContent = k;
    keyEl.classList.add('ready');
    showStat('Key generated successfully! Copy it now.', 'success');
    saveLast();
    genBtn.disabled = false;
    genBtn.classList.remove('loading');
    genBtn.textContent = 'Generate Another';
  }, 1200);
});

copyBtn.addEventListener('click', () => {
  const t = keyEl.textContent.trim();
  if (t.includes('Generate') || t.includes('passed')) {
    showStat('Generate a key first', 'error');
    return;
  }
  navigator.clipboard.writeText(t)
    .then(() => showStat('Key copied to clipboard ✓', 'success'))
    .catch(() => showStat('Copy failed — try manually', 'error'));
});
</script>

</body>
</html>
