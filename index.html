<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ace Key System • v7</title>

<style>
:root {
  --bg: #09090f;
  --card: #0f0f17;
  --text: #f1f5f9;
  --dim: #94a3b8;
  --accent: #22c55e;
  --accent-glow: rgba(34, 197, 94, 0.4);
  --border: rgba(255,255,255,0.06);
  --warning: #f59e0b;
  --error: #f87171;
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  background: var(--bg);
  color: var(--text);
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  min-height: 100vh;
  overflow: hidden;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}

.bg-gradient {
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at 25% 25%, rgba(34,197,94,0.1), transparent 50%);
  animation: breathe 30s ease-in-out infinite;
  z-index: -2;
}

@keyframes breathe { 0%,100% { transform: scale(1); opacity: 0.55; } 50% { transform: scale(1.22); opacity: 0.8; } }

.particles { position: absolute; inset: 0; pointer-events: none; z-index: -1; }
.particle {
  position: absolute;
  background: var(--accent);
  border-radius: 50%;
  opacity: 0;
  animation: drift linear infinite;
}

@keyframes drift { 0% { transform: translateY(100vh) scale(0.25); opacity: 0; } 12% { opacity: 0.35; } 88% { opacity: 0.35; } 100% { transform: translateY(-50vh) scale(0.55); opacity: 0; } }

.step {
  position: fixed;
  inset: 0;
  background: var(--bg);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 24px;
  z-index: 100;
  transition: opacity 1.1s ease, visibility 0s linear 1.3s;
}

.hidden { opacity: 0; visibility: hidden; }

h2.big {
  font-size: 5.2rem;
  font-weight: 900;
  background: linear-gradient(90deg, #a1e65c, #22c55e, #4ade80);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-size: 300% auto;
  animation: gradientFlow 8s linear infinite;
}

@keyframes gradientFlow { to { background-position: 300% center; } }

.by { margin: 28px 0 16px; font-size: 1.7rem; color: var(--dim); }
.love { font-size: 1.35rem; color: #fda4af; }

h1 { font-size: 2.5rem; margin-bottom: 20px; }
p { font-size: 1.12rem; color: var(--dim); max-width: 500px; margin: 0 auto 36px; line-height: 1.5; }

.progress-dots {
  display: flex;
  gap: 16px;
  margin-bottom: 40px;
}

.dot {
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: #222236;
  transition: all 0.5s ease;
}

.dot.active { background: var(--accent); box-shadow: 0 0 20px var(--accent-glow); transform: scale(1.6); }

input, .slider-container {
  width: 90%;
  max-width: 380px;
  padding: 16px;
  font-size: 1.3rem;
  border: 2px solid #2a2a3a;
  border-radius: 16px;
  background: #111122;
  color: var(--text);
  text-align: center;
  margin: 20px 0;
}

input:focus { border-color: var(--accent); outline: none; box-shadow: 0 0 0 3px rgba(34,197,94,0.2); }

.slider-container {
  height: 60px;
  background: #1a1a2e;
  border-radius: 30px;
  position: relative;
  overflow: hidden;
  cursor: grab;
  user-select: none;
}

.slider-track {
  position: absolute;
  inset: 0;
  background: linear-gradient(90deg, #111122, #1e1e38);
  transition: transform 0.1s;
}

.slider-knob {
  position: absolute;
  width: 56px;
  height: 56px;
  background: var(--accent);
  border-radius: 50%;
  top: 2px;
  left: 2px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.4rem;
  font-weight: bold;
  color: #000;
  transition: left 0.15s ease;
}

button {
  padding: 18px 48px;
  font-size: 1.2rem;
  font-weight: 700;
  border: none;
  border-radius: 20px;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  min-width: 260px;
  margin: 16px;
  position: relative;
}

.primary { background: linear-gradient(90deg, #22c55e, #4ade80); color: #000; box-shadow: 0 12px 35px rgba(34,197,94,0.5); }
.primary:hover:not(:disabled) { transform: translateY(-5px) scale(1.05); box-shadow: 0 20px 55px rgba(34,197,94,0.7); }

button:disabled { opacity: 0.5; cursor: not-allowed; transform: none; box-shadow: none; }

.status {
  font-size: 1.1rem;
  margin: 28px 0;
  min-height: 1.8em;
  line-height: 1.4;
}

.success { color: #4ade80; }
.error { color: var(--error); }
.wait { color: var(--warning); }

.container {
  width: 100%;
  max-width: 480px;
  background: var(--card);
  border-radius: 32px;
  border: 1px solid var(--border);
  padding: 48px 40px;
  text-align: center;
  box-shadow: 0 40px 100px rgba(0,0,0,0.85), inset 0 0 0 1px rgba(34,197,94,0.18);
  backdrop-filter: blur(16px);
  opacity: 0;
  transform: translateY(70px);
  animation: reveal 1.3s cubic-bezier(0.23,1,0.32,1.275) forwards;
}

@keyframes reveal { to { opacity: 1; transform: translateY(0); } }

.key-box {
  background: #0a0a10;
  border: 2px dashed rgba(34,197,94,0.5);
  border-radius: 22px;
  padding: 32px 24px;
  font-size: 1.6rem;
  font-family: 'Courier New', monospace;
  letter-spacing: 3.5px;
  margin: 36px 0;
  min-height: 110px;
  display: flex;
  align-items: center;
  justify-content: center;
  word-break: break-all;
  transition: all 0.7s;
}

.key-box.ready {
  border-style: solid;
  border-color: var(--accent);
  box-shadow: 0 0 70px var(--accent-glow);
  animation: keyPulse 3.5s infinite ease-in-out;
}

@keyframes keyPulse { 0%,100% { box-shadow: 0 0 45px rgba(34,197,94,0.35); } 50% { box-shadow: 0 0 90px rgba(34,197,94,0.6); } }

.footer { margin-top: 48px; font-size: 0.95rem; color: var(--dim); opacity: 0.8; }
</style>
</head>

<body>

<div class="bg-gradient"></div>
<div class="particles" id="particles"></div>

<!-- Intro -->
<div class="step" id="intro">
  <h2 class="big">Ace</h2>
  <div class="by">by aceii_</div>
  <div class="love">made with love ♡</div>
</div>

<!-- Step 1: Start -->
<div class="step hidden" id="step1">
  <h1>Welcome to Ace Verification</h1>
  <p>Complete these quick custom checks to unlock your key. Designed by aceii_ to keep it fair & secure.</p>
  <div class="progress-dots"><div class="dot active"></div><div class="dot"></div><div class="dot"></div></div>
  <button class="primary" id="startBtn">Begin Custom Verification</button>
</div>

<!-- Step 2: Math Riddle -->
<div class="step hidden" id="stepMath">
  <h1>Quick Math Check</h1>
  <p>Solve this simple equation to prove you're not automated:</p>
  <div id="mathQuestion" style="font-size:1.8rem; margin:24px 0; color:var(--accent); font-weight:bold;"></div>
  <input type="number" id="mathInput" placeholder="Your answer" />
  <div class="progress-dots"><div class="dot active"></div><div class="dot active"></div><div class="dot"></div></div>
  <button class="primary" id="submitMath">Submit Answer</button>
  <div id="mathStatus" class="status"></div>
</div>

<!-- Step 3: Slider Challenge -->
<div class="step hidden" id="stepSlider">
  <h1>Slider Alignment</h1>
  <p>Drag the knob to align it perfectly (within ±8px tolerance).</p>
  <div class="progress-dots"><div class="dot active"></div><div class="dot active"></div><div class="dot active"></div></div>
  <div class="slider-container" id="slider">
    <div class="slider-track" id="track"></div>
    <div class="slider-knob" id="knob">↔</div>
  </div>
  <div id="sliderStatus" class="status"></div>
</div>

<!-- Main Key UI -->
<div class="container hidden" id="main">
  <h1>Ace Key System</h1>
  <div class="sub">Your custom-verified access key • v7</div>

  <div id="key" class="key-box">Verification complete → Generate key</div>

  <button class="primary" id="generateBtn">Generate Key</button>
  <button class="secondary" id="copyBtn">Copy Key</button>

  <div id="status" class="status"></div>

  <div class="footer">by aceii_ • Key System v7 • 2026</div>
</div>

<script>
// Particles
function spawnParticles() {
  const c = document.getElementById('particles');
  for (let i = 0; i < 26; i++) {
    const p = document.createElement('div');
    p.className = 'particle';
    const sz = Math.random() * 7 + 2;
    p.style.width = p.style.height = sz + 'px';
    p.style.left = Math.random() * 100 + 'vw';
    p.style.animationDuration = (Math.random() * 32 + 22) + 's';
    p.style.animationDelay = Math.random() * -45 + 's';
    c.appendChild(p);
  }
}
spawnParticles();

// Transitions helper
function nextStep(currentId, nextId) {
  document.getElementById(currentId).classList.add('hidden');
  setTimeout(() => document.getElementById(nextId).classList.remove('hidden'), 500);
}

// Intro → Step 1
setTimeout(() => {
  document.getElementById('intro').classList.add('hidden');
  setTimeout(() => document.getElementById('step1').classList.remove('hidden'), 700);
}, 4200);

// Rate limit (60 min)
const RATE_MIN = 60;
const STORAGE_KEY = 'ace_key_last_ts';
function getLastTs() { return parseInt(localStorage.getItem(STORAGE_KEY) || '0'); }
function saveTs() { localStorage.setItem(STORAGE_KEY, Date.now()); }

function msToStr(ms) {
  const m = Math.floor(ms / 60000);
  const s = Math.floor((ms % 60000) / 1000);
  return `${m}m ${s}s`;
}

function startCooldown(rem) {
  const btn = document.getElementById('generateBtn');
  const st = document.getElementById('status');
  btn.disabled = true;
  btn.textContent = 'Wait...';
  const iv = setInterval(() => {
    rem -= 1000;
    if (rem <= 0) {
      clearInterval(iv);
      btn.disabled = false;
      btn.textContent = 'Generate Key';
      st.textContent = '';
      return;
    }
    st.className = 'status wait';
    st.textContent = `Next key available in ${msToStr(rem)}`;
  }, 1000);
}

// Step 1 → Math
document.getElementById('startBtn').addEventListener('click', () => nextStep('step1', 'stepMath'));

// Math logic
let mathAnswer = 0;
function genMath() {
  const a = Math.floor(Math.random() * 30) + 10;
  const b = Math.floor(Math.random() * 20) + 5;
  mathAnswer = a + b;
  document.getElementById('mathQuestion').textContent = `${a} + ${b} = ?`;
}
genMath();

document.getElementById('submitMath').addEventListener('click', () => {
  const inp = document.getElementById('mathInput').value.trim();
  const st = document.getElementById('mathStatus');
  if (!inp || isNaN(inp)) {
    st.className = 'status error';
    st.textContent = 'Enter a number!';
    return;
  }
  if (parseInt(inp) === mathAnswer) {
    st.className = 'status success';
    st.textContent = 'Correct! Moving on...';
    setTimeout(() => nextStep('stepMath', 'stepSlider'), 800);
  } else {
    st.className = 'status error';
    st.textContent = 'Wrong — try again';
    genMath(); // new question
    document.getElementById('mathInput').value = '';
  }
});

// Slider logic
let isDragging = false;
let startX = 0;
let currentX = 0;
const slider = document.getElementById('slider');
const knob = document.getElementById('knob');
const track = document.getElementById('track');
const sliderStatus = document.getElementById('sliderStatus');

const maxSlide = slider.offsetWidth - knob.offsetWidth - 4;
const target = Math.floor(Math.random() * (maxSlide * 0.6)) + (maxSlide * 0.2); // random target zone

knob.style.left = '2px';

function updateKnob(x) {
  currentX = Math.max(2, Math.min(x, maxSlide + 2));
  knob.style.left = currentX + 'px';
}

slider.addEventListener('mousedown', e => {
  isDragging = true;
  startX = e.clientX - currentX;
  slider.style.cursor = 'grabbing';
});
slider.addEventListener('touchstart', e => {
  isDragging = true;
  startX = e.touches[0].clientX - currentX;
  e.preventDefault();
});

document.addEventListener('mousemove', e => {
  if (!isDragging) return;
  updateKnob(e.clientX - startX);
});
document.addEventListener('touchmove', e => {
  if (!isDragging) return;
  updateKnob(e.touches[0].clientX - startX);
  e.preventDefault();
});

document.addEventListener('mouseup', () => {
  if (!isDragging) return;
  isDragging = false;
  slider.style.cursor = 'grab';
  checkSlider();
});
document.addEventListener('touchend', () => {
  if (!isDragging) return;
  isDragging = false;
  checkSlider();
});

function checkSlider() {
  const dist = Math.abs(currentX - target);
  if (dist <= 8) { // tolerance
    sliderStatus.className = 'status success';
    sliderStatus.textContent = 'Aligned perfectly! ✓';
    setTimeout(() => nextStep('stepSlider', 'main'), 1000);
  } else {
    sliderStatus.className = 'status error';
    sliderStatus.textContent = `Off by ${Math.round(dist)}px — try again`;
    // optional: reset knob after fail
    setTimeout(() => {
      currentX = 2;
      knob.style.left = '2px';
      sliderStatus.textContent = '';
    }, 1200);
  }
}

// Key generation
const keyEl = document.getElementById('key');
const genBtn = document.getElementById('generateBtn');
const copyBtn = document.getElementById('copyBtn');
const stat = document.getElementById('status');

function randBlock(n) {
  const chars = "ABCDEFGHJKLMNPQRSTUVWXYZ23456789";
  let s = '';
  for (let i = 0; i < n; i++) s += chars[Math.floor(Math.random() * chars.length)];
  return s;
}

function showStat(msg, cls = '') {
  stat.textContent = msg;
  stat.className = `status ${cls}`;
}

genBtn.addEventListener('click', () => {
  const now = Date.now();
  const last = getLastTs();
  if (now - last < RATE_MIN * 60000) {
    const rem = RATE_MIN * 60000 - (now - last);
    showStat(`Wait ${msToStr(rem)} before next generation`, 'wait');
    startCooldown(rem);
    return;
  }

  genBtn.disabled = true;
  genBtn.textContent = 'Generating...';

  setTimeout(() => {
    const k = `ACE-${randBlock(5)}-${randBlock(5)}-${randBlock(4)}`;
    keyEl.textContent = k;
    keyEl.classList.add('ready');
    showStat('Key ready! Copy & enjoy.', 'success');
    saveTs();
    genBtn.disabled = false;
    genBtn.textContent = 'Generate New';
  }, 1100);
});

copyBtn.addEventListener('click', () => {
  const t = keyEl.textContent.trim();
  if (t.includes('Generate') || t.includes('complete')) {
    showStat('Generate your key first', 'error');
    return;
  }
  navigator.clipboard.writeText(t)
    .then(() => showStat('Copied to clipboard ✓', 'success'))
    .catch(() => showStat('Copy failed — select manually', 'error'));
});
</script>

</body>
</html>
